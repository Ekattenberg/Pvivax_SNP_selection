# Pvivax_SNP_selection

This github contains an example jupyter notebook with python3 code and a second with R code to perform the SNP selection steps for a within-country barcode for molecular surveillance as explained in the manuscript "Novel highly-multiplexed AmpliSeq targeted assay for Plasmodium vivax genetic surveillance use cases at multiple geographical scales" by Kattenberg et al. 2022. 

The purpose of this repository is to be transparent in the analyses performed and to allow other to replicate the SNP selection procedures. 
If you use the same SNP selection procedure, please cite our paper (publication details will follow as soon as accepted). 

In brief the different steps for the SNP selection are: 
The high quality SNPs were used in a pipeline to select SNPs for the within-country barcode. The first few steps are to remove loci with too much missing data, and samples with lots of missing data. Then LD-pruning is conducted (usually in 5-6 iterations) by scanning over the genome in 500 bp windows to remove uninformative SNPs with pairwise LD>0.2 using the python package sckikit-allel. Remaining SNPs where then filtered for a minor allele frequency (MAF) above 10%, and selectively neutral SNPs were selected by calculating Tajima’s D in 500bp windows (sckikit-allel) and retaining those where |Tajima’s D|>0.5. These procedures are described in the notebook in this repository. The different steps are performed for each chromosome individually, the example selects variants from chromosome 14. Then the selected loci are filtered from the vcf file (using vcftools) and further analysed in R for a final selection of SNPs. The contributions of the SNPs to geospatial genetic clusters are determined using discriminant analysis of principal components (DAPC) with province populations and K-means inferred populations using adegenet package in R, as described in the final selection notebook. SNPs with a large contribution to geographical spread and genetic clusters in the DAPC analysis, are selected. A final selection is made by choosing 3 SNPs per chromosome with high allele loadings in the DAPC, spread over the chromosome and not too close proximity (>500 bp) to drug resistant amplicons in the Pv AmpliSeq assay design to avoid linkage. 
